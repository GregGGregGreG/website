function initMap(){var e={center:new google.maps.LatLng(34.299,66.5175319),zoom:7,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!1,styles:mapStyle};map=new google.maps.Map(document.getElementById("register-map"),e),google.maps.event.addListener(map,"click",function(e){placeMarker(e.latLng)});var o=new XMLHttpRequest;o.onreadystatechange=function(){if(4==this.readyState&&200==this.status){locations=JSON.parse(this.responseText);for(var e=0;e<locations.length;e++){var o=locations[e].location.split(",");myLatLng=new google.maps.LatLng(o[0],o[1]);var a=new google.maps.Marker({map:map,position:myLatLng,optimized:!1,url:locations[e].html_url,title:locations[e].nickname,icon:{url:locations[e].avatar,scaledSize:new google.maps.Size(50,50),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(10,0)}});a.setMap(map),markers.push(a),google.maps.event.addListener(a,"click",function(){window.open(this.url,"_blank")})}addMarkerCluster()}},o.open("GET","/registered/locations",!0),o.send(),getLocation(map)}function addMarkerCluster(){new MarkerClusterer(map,markers,{imagePath:"https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m",maxZoom:18})}function getLocation(e){var o=document.getElementById("search-location"),a=new google.maps.places.SearchBox(o);e.addListener("bounds_changed",function(){a.setBounds(e.getBounds())}),a.addListener("places_changed",function(){var o=a.getPlaces();if(0!=o.length){var t=new google.maps.LatLngBounds;o.forEach(function(e){e.geometry.viewport?t.union(e.geometry.viewport):t.extend(e.geometry.location)}),e.fitBounds(t)}})}function placeMarker(e){markerLocator?markerLocator.setPosition(e):markerLocator=new google.maps.Marker({map:map,position:e,icon:{url:"http://en.lesmenuires.com/wp-content/themes/noeStarter/images/markers/default.png",scaledSize:new google.maps.Size(50,50),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(10,0)}}),$("#location").val(e.lat()+","+e.lng())}var markers=[],locations=[],markerLocator;$(".datepicker").datepicker({autoclose:!0,format:"yyyy-mm-dd"});